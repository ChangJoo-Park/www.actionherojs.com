<!DOCTYPE html><html><head><link rel="preload" href="/_next/e2246878-227f-4809-bcfe-8b4d3e2ec98c/page/docs/core/tasks/index.js" as="script"/><link rel="preload" href="/_next/e2246878-227f-4809-bcfe-8b4d3e2ec98c/page/_error/index.js" as="script"/><link rel="preload" href="/_next/517642acd6437ad7e589c92138f402c3/app.js" as="script"/><meta charset="utf-8" class="next-head"/><link rel="apple-touch-icon" sizes="57x57" href="/static/images/icons/apple-icon-57x57.png" class="next-head"/><link rel="apple-touch-icon" sizes="60x60" href="/static/images/icons/apple-icon-60x60.png" class="next-head"/><link rel="apple-touch-icon" sizes="72x72" href="/static/images/icons/apple-icon-72x72.png" class="next-head"/><link rel="apple-touch-icon" sizes="76x76" href="/static/images/icons/apple-icon-76x76.png" class="next-head"/><link rel="apple-touch-icon" sizes="114x114" href="/static/images/icons/apple-icon-114x114.png" class="next-head"/><link rel="apple-touch-icon" sizes="120x120" href="/static/images/icons/apple-icon-120x120.png" class="next-head"/><link rel="apple-touch-icon" sizes="144x144" href="/static/images/icons/apple-icon-144x144.png" class="next-head"/><link rel="apple-touch-icon" sizes="152x152" href="/static/images/icons/apple-icon-152x152.png" class="next-head"/><link rel="apple-touch-icon" sizes="180x180" href="/static/images/icons/apple-icon-180x180.png" class="next-head"/><link rel="icon" type="image/png" sizes="192x192" href="/static/images/icons/android-icon-192x192.png" class="next-head"/><link rel="icon" type="image/png" sizes="32x32" href="/static/images/icons/favicon-32x32.png" class="next-head"/><link rel="icon" type="image/png" sizes="96x96" href="/static/images/icons/favicon-96x96.png" class="next-head"/><link rel="icon" type="image/png" sizes="16x16" href="/static/images/icons/favicon-16x16.png" class="next-head"/><meta name="viewport" content="width=device-width" class="next-head"/><link rel="stylesheet" type="text/css" href="/static/css/bootstrap.min.css" class="next-head"/><link rel="stylesheet" type="text/css" href="/static/css/bebasNeue.css" class="next-head"/><link rel="stylesheet" type="text/css" href="/static/css/animations.css" class="next-head"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700,800|Roboto:100,300,400,500,700,900" rel="stylesheet" class="next-head"/><title class="next-head">ActionHero</title><script src="/static/js/googleAnalytics.js" class="next-head"></script><link rel="stylesheet" href="https://unpkg.com/react-instantsearch-theme-algolia@4.0.0/style.min.css" class="next-head"/></head><body><div><div id="__next"><div data-reactroot="" data-reactid="1" data-react-checksum="594866503"><div data-reactid="2"><!-- react-empty: 3 --><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300;" class="container-fluid" data-reactid="4"><header style="background-color:#2F5266;" data-reactid="5"><div class="container" data-reactid="6"><nav style="background-color:#2F5266;padding-top:5px;margin-bottom:10px;border:0;" class="navbar navbar-default" data-reactid="7"><div class="container" data-reactid="8"><div class="navbar-header" data-reactid="9"><a style="padding-top:0;margin-bottom:15px;" class="navbar-brand" data-reactid="10"><img src="/static/images/actionhero-logo-header-wordmark.svg" style="padding-top:14px;padding-bottom:20px;" data-reactid="11"/></a><button type="button" class="navbar-toggle collapsed" data-reactid="12"><span class="sr-only" data-reactid="13">Toggle navigation</span><span class="icon-bar" data-reactid="14"></span><span class="icon-bar" data-reactid="15"></span><span class="icon-bar" data-reactid="16"></span></button></div><div class="navbar-collapse collapse" data-reactid="17"><ul class="nav navbar-nav navbar-right" data-reactid="18"></ul><ul class="hidden-md hidden-sm hidden-xs nav navbar-nav navbar-left" data-reactid="19"><li role="presentation" class="" data-reactid="20"><a role="button" href="#" data-reactid="21"> </a></li><li role="presentation" class="" data-reactid="22"><a role="button" href="#" data-reactid="23"> </a></li><li role="presentation" class="" data-reactid="24"><a role="button" href="#" data-reactid="25"> </a></li><li role="presentation" class="" data-reactid="26"><a role="button" href="#" data-reactid="27"> </a></li></ul><ul class="nav navbar-nav navbar-left" data-reactid="28"><li role="presentation" class="" data-reactid="29"><a role="button" href="#" data-reactid="30"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;" data-reactid="31">Downloads</span></a></li><li role="presentation" class="" data-reactid="32"><a role="button" href="#" data-reactid="33"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;" data-reactid="34">Documentation</span></a></li><li role="presentation" class="hidden-sm" data-reactid="35"><a role="button" href="#" data-reactid="36"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;" data-reactid="37">Solutions</span></a></li><li role="presentation" class="" data-reactid="38"><a role="button" href="#" data-reactid="39"><span style="line-height:3;color:#FFFFFF;padding-bottom:10px;font-weight:300;" data-reactid="40">Community</span></a></li></ul><ul class="nav navbar-nav navbar-right" data-reactid="41"><div data-reactid="42"><a style="text-decoration:none;" href="/get-started/" data-reactid="43"><button style="font-family:Roboto, sans-serif;font-size:14px;max-width:200px;border-radius:50px;margin:0 auto;color:#FFFFFF;background-color:#6E8898;border-color:#6E8898;font-weight:300;margin-top:20px;margin-bottom:0;margin-left:10px;margin-right:10px;outline:none;" type="button" class="btn btn-lg btn-default btn-block" data-reactid="44">Get Started</button></a></div></ul></div></div></nav></div></header></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300;" class="container-fluid" data-reactid="45"><div style="background-color:#FBF9E4;color:#2F5266;font-weight:200;padding:50px;" data-reactid="46"><div class="container" data-reactid="47"><div class="row" data-reactid="48"><div style="text-align:center;" class="col-md-3" data-reactid="49"><img src="/static/images/built-in-tasks.svg" data-reactid="50"/></div><div style="text-align:center;" class="col-md-6" data-reactid="51"><h1 style="font-family:BebasNeue, Roboto, sans-serif;font-weight:bold;margin-top:20px;margin-bottom:10px;letter-spacing:2px;font-size:36px;" data-reactid="52"><br data-reactid="53"/><!-- react-text: 54 -->Core: Tasks<!-- /react-text --></h1></div><div class="col-md-3" data-reactid="55"></div></div></div></div><div style="height:183px;background:url(&quot;/static/images/clouds-white.svg&quot;) no-repeat center #FBF9E4;" data-reactid="56"></div><div style="padding-bottom:100px;" class="container" data-reactid="57"><div class="row" data-reactid="58"><div id="_top" data-reactid="59"></div><div id="docPageContent" class="col-md-9" data-reactid="60"><div class="row" data-reactid="61"><div class="col-md-12" data-reactid="62"><div data-reactid="63"><br data-reactid="64"/><h2 id="overview" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="65"><span style="font-weight:300;font-size:36px;" data-reactid="66">Overview</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px;" data-reactid="67"/><div style="font-family:Open Sans, sans-serif;" data-reactid="68"><div data-reactid="69"><p data-reactid="70"><!-- react-text: 71 -->Tasks are background jobs meant to be run separately from a client&#x27;s request.  They can be started by an action or by the server itself.  With ActionHero, there is no need to run a separate daemon to process these jobs.  ActionHero uses the <!-- /react-text --><a href="https://github.com/taskrabbit/node-resque" data-reactid="72">node-resque</a><!-- react-text: 73 --> package to store and process tasks in a way compatible with the <!-- /react-text --><a href="https://github.com/resque/resque" data-reactid="74">resque</a><!-- react-text: 75 --> ecosystem.<!-- /react-text --></p><p data-reactid="76"><!-- react-text: 77 -->There are 3 types of tasks ActionHero can process: <!-- /react-text --><code data-reactid="78">normal</code><!-- react-text: 79 -->, <!-- /react-text --><code data-reactid="80">delayed</code><!-- react-text: 81 -->, and <!-- /react-text --><code data-reactid="82">periodic</code><!-- react-text: 83 -->.<!-- /react-text --></p><ul data-reactid="84"><li data-reactid="85"><code data-reactid="86">normal</code><!-- react-text: 87 --> tasks are enqueued and processed one-by-one by the task TaskProcessors<!-- /react-text --></li><li data-reactid="88"><code data-reactid="89">delayed</code><!-- react-text: 90 --> tasks are enqueued in a special `delayed` queue to only be processed at some time in the future (defined either by a timestamp in ms or milliseconds-from-now)<!-- /react-text --></li><li data-reactid="91"><code data-reactid="92">periodic</code><!-- react-text: 93 --> tasks are like delayed tasks, but they run on a set frequency (e.g. every 5 minutes).<!-- /react-text --><ul data-reactid="94"><li data-reactid="95">Periodic tasks can take no input parameters.</li></ul></li></ul></div></div></div><div data-reactid="96"><br data-reactid="97"/><h2 id="enqueing" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="98"><span style="font-weight:300;font-size:36px;" data-reactid="99">Enqueing Tasks</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px;" data-reactid="100"/><div style="font-family:Open Sans, sans-serif;" data-reactid="101"><div data-reactid="102"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8;" data-reactid="103"><code data-reactid="104"><span style="color:#998;font-style:italic;" data-reactid="105"><!-- react-text: 106 -->// Enqueue the task now, and process it ASAP<!-- /react-text --></span><!-- react-text: 107 -->
<!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="108"><!-- react-text: 109 -->// api.tasks.enqueue(nameOfTask, args, queue, callback)<!-- /react-text --></span><!-- react-text: 110 -->
api.tasks.enqueue(<!-- /react-text --><span style="color:#d14;" data-reactid="111"><!-- react-text: 112 -->&quot;sendWelcomeEmail&quot;<!-- /react-text --></span><!-- react-text: 113 -->, {<!-- /react-text --><span data-reactid="114"><!-- react-text: 115 -->to<!-- /react-text --></span><!-- react-text: 116 -->: <!-- /react-text --><span style="color:#d14;" data-reactid="117"><!-- react-text: 118 -->&#x27;evan@evantahler.com&#x27;<!-- /react-text --></span><!-- react-text: 119 -->}, <!-- /react-text --><span style="color:#d14;" data-reactid="120"><!-- react-text: 121 -->&#x27;default&#x27;<!-- /react-text --></span><!-- react-text: 122 -->, <!-- /react-text --><span data-reactid="123"><span style="color:#333;font-weight:bold;" data-reactid="124"><!-- react-text: 125 -->function<!-- /react-text --></span><!-- react-text: 126 -->(<!-- /react-text --><span data-reactid="127"><!-- react-text: 128 -->error, toRun<!-- /react-text --></span><!-- react-text: 129 -->)<!-- /react-text --></span><!-- react-text: 130 -->{
  <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="131"><!-- react-text: 132 -->// enqueued!<!-- /react-text --></span><!-- react-text: 133 -->
});

<!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="134"><!-- react-text: 135 -->// Enqueue the task now, and process it once `timestamp` has arrived<!-- /react-text --></span><!-- react-text: 136 -->
<!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="137"><!-- react-text: 138 -->// api.tasks.enqueueAt(timestamp, nameOfTask, args, queue, callback)<!-- /react-text --></span><!-- react-text: 139 -->
api.tasks.enqueueAt(<!-- /react-text --><span style="color:#008080;" data-reactid="140"><!-- react-text: 141 -->1234556<!-- /react-text --></span><!-- react-text: 142 -->, <!-- /react-text --><span style="color:#d14;" data-reactid="143"><!-- react-text: 144 -->&quot;sendWelcomeEmail&quot;<!-- /react-text --></span><!-- react-text: 145 -->, {<!-- /react-text --><span data-reactid="146"><!-- react-text: 147 -->to<!-- /react-text --></span><!-- react-text: 148 -->: <!-- /react-text --><span style="color:#d14;" data-reactid="149"><!-- react-text: 150 -->&#x27;evan@evantahler.com&#x27;<!-- /react-text --></span><!-- react-text: 151 -->}, <!-- /react-text --><span style="color:#d14;" data-reactid="152"><!-- react-text: 153 -->&#x27;default&#x27;<!-- /react-text --></span><!-- react-text: 154 -->, <!-- /react-text --><span data-reactid="155"><span style="color:#333;font-weight:bold;" data-reactid="156"><!-- react-text: 157 -->function<!-- /react-text --></span><!-- react-text: 158 -->(<!-- /react-text --><span data-reactid="159"><!-- react-text: 160 -->error, toRun<!-- /react-text --></span><!-- react-text: 161 -->)<!-- /react-text --></span><!-- react-text: 162 -->{
  <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="163"><!-- react-text: 164 -->// enqueued!<!-- /react-text --></span><!-- react-text: 165 -->
});

<!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="166"><!-- react-text: 167 -->// Enqueue the task now, and process it once `delay` (ms) has passed<!-- /react-text --></span><!-- react-text: 168 -->
<!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="169"><!-- react-text: 170 -->// api.tasks.enqueueIn(delay, nameOfTask, args, queue, callback)<!-- /react-text --></span><!-- react-text: 171 -->
api.tasks.enqueueIn(<!-- /react-text --><span style="color:#008080;" data-reactid="172"><!-- react-text: 173 -->10000<!-- /react-text --></span><!-- react-text: 174 -->, <!-- /react-text --><span style="color:#d14;" data-reactid="175"><!-- react-text: 176 -->&quot;sendWelcomeEmail&quot;<!-- /react-text --></span><!-- react-text: 177 -->, {<!-- /react-text --><span data-reactid="178"><!-- react-text: 179 -->to<!-- /react-text --></span><!-- react-text: 180 -->: <!-- /react-text --><span style="color:#d14;" data-reactid="181"><!-- react-text: 182 -->&#x27;evan@evantahler.com&#x27;<!-- /react-text --></span><!-- react-text: 183 -->}, <!-- /react-text --><span style="color:#d14;" data-reactid="184"><!-- react-text: 185 -->&#x27;default&#x27;<!-- /react-text --></span><!-- react-text: 186 -->, <!-- /react-text --><span data-reactid="187"><span style="color:#333;font-weight:bold;" data-reactid="188"><!-- react-text: 189 -->function<!-- /react-text --></span><!-- react-text: 190 -->(<!-- /react-text --><span data-reactid="191"><!-- react-text: 192 -->error, toRun<!-- /react-text --></span><!-- react-text: 193 -->)<!-- /react-text --></span><!-- react-text: 194 -->{
  <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="195"><!-- react-text: 196 -->// enqueued!<!-- /react-text --></span><!-- react-text: 197 -->
});
<!-- /react-text --></code></pre><p data-reactid="198">Here are examples of the 3 ways to programmatically enqueue a task.</p><p data-reactid="199"><!-- react-text: 200 -->&quot;sendWelcomeEmail&quot; should be a task defined in the project, and <!-- /react-text --><code data-reactid="201">{to: &#x27;evan@evantahler.com&#x27;}</code><!-- react-text: 202 --> are arguments to that task.  This task will be processed by TaskProcessors assigned to the <!-- /react-text --><!-- react-text: 203 -->‘default queue&#x27;<!-- /react-text --><!-- react-text: 204 -->.<!-- /react-text --></p><p data-reactid="205">You can also enqueue tasks to be run at some time in the future (timestamp is in ms):</p><p data-reactid="206"><code data-reactid="207">enqueueAt</code><!-- react-text: 208 --> asks for a timestamp (in ms) to run at, and <!-- /react-text --><code data-reactid="209">enqueueIn</code><!-- react-text: 210 --> asks for the number of ms from now to run.<!-- /react-text --></p><p data-reactid="211"><!-- react-text: 212 -->The final type of task, periodic tasks, are defined with a <!-- /react-text --><code data-reactid="213">task.frequency</code><!-- react-text: 214 --> of greater than 0, and are loaded in by ActionHero when it boots.  You cannot modify these tasks once the server is running.<!-- /react-text --></p></div></div></div><div data-reactid="215"><br data-reactid="216"/><h2 id="processing-tasks" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="217"><span style="font-weight:300;font-size:36px;" data-reactid="218">Processing Tasks</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px;" data-reactid="219"/><div style="font-family:Open Sans, sans-serif;" data-reactid="220"><div data-reactid="221"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8;" data-reactid="222"><code data-reactid="223"><span style="color:#998;font-style:italic;" data-reactid="224"><!-- react-text: 225 -->// From /config/tasks.js:<!-- /react-text --></span><!-- react-text: 226 -->

exports.default = {
  <!-- /react-text --><span data-reactid="227"><!-- react-text: 228 -->tasks<!-- /react-text --></span><!-- react-text: 229 -->: <!-- /react-text --><span data-reactid="230"><span style="color:#333;font-weight:bold;" data-reactid="231"><!-- react-text: 232 -->function<!-- /react-text --></span><!-- react-text: 233 -->(<!-- /react-text --><span data-reactid="234"><!-- react-text: 235 -->api<!-- /react-text --></span><!-- react-text: 236 -->)<!-- /react-text --></span><!-- react-text: 237 -->{
    <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="238"><!-- react-text: 239 -->return<!-- /react-text --></span><!-- react-text: 240 --> {
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="241"><!-- react-text: 242 -->// Should this node run a scheduler to promote delayed tasks?<!-- /react-text --></span><!-- react-text: 243 -->
      scheduler: <!-- /react-text --><span style="color:#008080;" data-reactid="244"><!-- react-text: 245 -->false<!-- /react-text --></span><!-- react-text: 246 -->,
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="247"><!-- react-text: 248 -->// what queues should the TaskProcessors work?<!-- /react-text --></span><!-- react-text: 249 -->
      queues: [<!-- /react-text --><span style="color:#d14;" data-reactid="250"><!-- react-text: 251 -->&#x27;*&#x27;<!-- /react-text --></span><!-- react-text: 252 -->],
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="253"><!-- react-text: 254 -->// Logging levels of task workers<!-- /react-text --></span><!-- react-text: 255 -->
      workerLogging : {
        <!-- /react-text --><span data-reactid="256"><!-- react-text: 257 -->failure<!-- /react-text --></span><!-- react-text: 258 -->   : <!-- /react-text --><span style="color:#d14;" data-reactid="259"><!-- react-text: 260 -->&#x27;error&#x27;<!-- /react-text --></span><!-- react-text: 261 -->, <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="262"><!-- react-text: 263 -->// task failure<!-- /react-text --></span><!-- react-text: 264 -->
        success   : <!-- /react-text --><span style="color:#d14;" data-reactid="265"><!-- react-text: 266 -->&#x27;info&#x27;<!-- /react-text --></span><!-- react-text: 267 -->,  <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="268"><!-- react-text: 269 -->// task success<!-- /react-text --></span><!-- react-text: 270 -->
        start     : <!-- /react-text --><span style="color:#d14;" data-reactid="271"><!-- react-text: 272 -->&#x27;info&#x27;<!-- /react-text --></span><!-- react-text: 273 -->,
        <!-- /react-text --><span data-reactid="274"><!-- react-text: 275 -->end<!-- /react-text --></span><!-- react-text: 276 -->       : <!-- /react-text --><span style="color:#d14;" data-reactid="277"><!-- react-text: 278 -->&#x27;info&#x27;<!-- /react-text --></span><!-- react-text: 279 -->,
        <!-- /react-text --><span data-reactid="280"><!-- react-text: 281 -->cleaning_worker<!-- /react-text --></span><!-- react-text: 282 --> : <!-- /react-text --><span style="color:#d14;" data-reactid="283"><!-- react-text: 284 -->&#x27;info&#x27;<!-- /react-text --></span><!-- react-text: 285 -->,
        <!-- /react-text --><span data-reactid="286"><!-- react-text: 287 -->poll<!-- /react-text --></span><!-- react-text: 288 -->      : <!-- /react-text --><span style="color:#d14;" data-reactid="289"><!-- react-text: 290 -->&#x27;debug&#x27;<!-- /react-text --></span><!-- react-text: 291 -->,
        <!-- /react-text --><span data-reactid="292"><!-- react-text: 293 -->job<!-- /react-text --></span><!-- react-text: 294 -->       : <!-- /react-text --><span style="color:#d14;" data-reactid="295"><!-- react-text: 296 -->&#x27;debug&#x27;<!-- /react-text --></span><!-- react-text: 297 -->,
        <!-- /react-text --><span data-reactid="298"><!-- react-text: 299 -->pause<!-- /react-text --></span><!-- react-text: 300 -->     : <!-- /react-text --><span style="color:#d14;" data-reactid="301"><!-- react-text: 302 -->&#x27;debug&#x27;<!-- /react-text --></span><!-- react-text: 303 -->,
        <!-- /react-text --><span data-reactid="304"><!-- react-text: 305 -->internalError<!-- /react-text --></span><!-- react-text: 306 --> : <!-- /react-text --><span style="color:#d14;" data-reactid="307"><!-- react-text: 308 -->&#x27;error&#x27;<!-- /react-text --></span><!-- react-text: 309 -->,
        <!-- /react-text --><span data-reactid="310"><!-- react-text: 311 -->multiWorkerAction<!-- /react-text --></span><!-- react-text: 312 --> : <!-- /react-text --><span style="color:#d14;" data-reactid="313"><!-- react-text: 314 -->&#x27;debug&#x27;<!-- /react-text --></span><!-- react-text: 315 -->
      },
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="316"><!-- react-text: 317 -->// Logging levels of the task scheduler<!-- /react-text --></span><!-- react-text: 318 -->
      schedulerLogging : {
        <!-- /react-text --><span data-reactid="319"><!-- react-text: 320 -->start<!-- /react-text --></span><!-- react-text: 321 -->     : <!-- /react-text --><span style="color:#d14;" data-reactid="322"><!-- react-text: 323 -->&#x27;info&#x27;<!-- /react-text --></span><!-- react-text: 324 -->,
        <!-- /react-text --><span data-reactid="325"><!-- react-text: 326 -->end<!-- /react-text --></span><!-- react-text: 327 -->       : <!-- /react-text --><span style="color:#d14;" data-reactid="328"><!-- react-text: 329 -->&#x27;info&#x27;<!-- /react-text --></span><!-- react-text: 330 -->,
        <!-- /react-text --><span data-reactid="331"><!-- react-text: 332 -->poll<!-- /react-text --></span><!-- react-text: 333 -->      : <!-- /react-text --><span style="color:#d14;" data-reactid="334"><!-- react-text: 335 -->&#x27;debug&#x27;<!-- /react-text --></span><!-- react-text: 336 -->,
        <!-- /react-text --><span data-reactid="337"><!-- react-text: 338 -->enqueue<!-- /react-text --></span><!-- react-text: 339 -->   : <!-- /react-text --><span style="color:#d14;" data-reactid="340"><!-- react-text: 341 -->&#x27;debug&#x27;<!-- /react-text --></span><!-- react-text: 342 -->,
        <!-- /react-text --><span data-reactid="343"><!-- react-text: 344 -->reEnqueue<!-- /react-text --></span><!-- react-text: 345 --> : <!-- /react-text --><span style="color:#d14;" data-reactid="346"><!-- react-text: 347 -->&#x27;debug&#x27;<!-- /react-text --></span><!-- react-text: 348 -->,
        <!-- /react-text --><span data-reactid="349"><!-- react-text: 350 -->working_timestamp<!-- /react-text --></span><!-- react-text: 351 --> : <!-- /react-text --><span style="color:#d14;" data-reactid="352"><!-- react-text: 353 -->&#x27;debug&#x27;<!-- /react-text --></span><!-- react-text: 354 -->,
        <!-- /react-text --><span data-reactid="355"><!-- react-text: 356 -->transferred_job<!-- /react-text --></span><!-- react-text: 357 -->   : <!-- /react-text --><span style="color:#d14;" data-reactid="358"><!-- react-text: 359 -->&#x27;debug&#x27;<!-- /react-text --></span><!-- react-text: 360 -->
      },
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="361"><!-- react-text: 362 -->// how long to sleep between jobs / scheduler checks<!-- /react-text --></span><!-- react-text: 363 -->
      timeout: <!-- /react-text --><span style="color:#008080;" data-reactid="364"><!-- react-text: 365 -->5000<!-- /react-text --></span><!-- react-text: 366 -->,
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="367"><!-- react-text: 368 -->// at minimum, how many parallel taskProcessors should this node spawn?<!-- /react-text --></span><!-- react-text: 369 -->
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="370"><!-- react-text: 371 -->// (have number &gt; 0 to enable, and &lt; 1 to disable)<!-- /react-text --></span><!-- react-text: 372 -->
      minTaskProcessors: <!-- /react-text --><span style="color:#008080;" data-reactid="373"><!-- react-text: 374 -->0<!-- /react-text --></span><!-- react-text: 375 -->,
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="376"><!-- react-text: 377 -->// at maximum, how many parallel taskProcessors should this node spawn?<!-- /react-text --></span><!-- react-text: 378 -->
      maxTaskProcessors: <!-- /react-text --><span style="color:#008080;" data-reactid="379"><!-- react-text: 380 -->0<!-- /react-text --></span><!-- react-text: 381 -->,
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="382"><!-- react-text: 383 -->// how often should we check the event loop to spawn more TaskProcessors?<!-- /react-text --></span><!-- react-text: 384 -->
      checkTimeout: <!-- /react-text --><span style="color:#008080;" data-reactid="385"><!-- react-text: 386 -->500<!-- /react-text --></span><!-- react-text: 387 -->,
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="388"><!-- react-text: 389 -->// how many ms would constitue an event loop delay to halt TaskProcessors spawning?<!-- /react-text --></span><!-- react-text: 390 -->
      maxEventLoopDelay: <!-- /react-text --><span style="color:#008080;" data-reactid="391"><!-- react-text: 392 -->5<!-- /react-text --></span><!-- react-text: 393 -->,
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="394"><!-- react-text: 395 -->// When we kill off a taskProcessor, should we disonnect that local redis connection?<!-- /react-text --></span><!-- react-text: 396 -->
      toDisconnectProcessors: <!-- /react-text --><span style="color:#008080;" data-reactid="397"><!-- react-text: 398 -->true<!-- /react-text --></span><!-- react-text: 399 -->,
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="400"><!-- react-text: 401 -->// Customize Resque primitives, replace null with required replacement.<!-- /react-text --></span><!-- react-text: 402 -->
      resque_overrides: {
        <!-- /react-text --><span data-reactid="403"><!-- react-text: 404 -->queue<!-- /react-text --></span><!-- react-text: 405 -->: <!-- /react-text --><span style="color:#008080;" data-reactid="406"><!-- react-text: 407 -->null<!-- /react-text --></span><!-- react-text: 408 -->,
        <!-- /react-text --><span data-reactid="409"><!-- react-text: 410 -->multiWorker<!-- /react-text --></span><!-- react-text: 411 -->: <!-- /react-text --><span style="color:#008080;" data-reactid="412"><!-- react-text: 413 -->null<!-- /react-text --></span><!-- react-text: 414 -->,
        <!-- /react-text --><span data-reactid="415"><!-- react-text: 416 -->scheduler<!-- /react-text --></span><!-- react-text: 417 -->: <!-- /react-text --><span style="color:#008080;" data-reactid="418"><!-- react-text: 419 -->null<!-- /react-text --></span><!-- react-text: 420 -->
      }
    }
  }
}<!-- /react-text --></code></pre><p data-reactid="421"><!-- react-text: 422 -->To work these tasks, you need to run ActionHero with at least one <!-- /react-text --><code data-reactid="423">taskProcessor</code><!-- react-text: 424 -->. <!-- /react-text --><code data-reactid="425">TaskProcessor</code><!-- react-text: 426 -->s run in-line with the rest of your server and process jobs.  This is controlled by settings in <!-- /react-text --><a href="https://github.com/actionhero/actionhero/blob/master/config/tasks.js" data-reactid="427">/config/tasks.js</a><!-- react-text: 428 -->.<!-- /react-text --></p><p data-reactid="429">If you are enqueuing delayed or periodic tasks, you also need to enable the scheduler.  This is a part of ActionHero that will periodically check the delayed queues for jobs that are ready to work now, and move them to the normal queues when the time comes.</p><p data-reactid="430"><!-- react-text: 431 -->Because node and ActionHero are asynchronous, we can process more than one job at a time.  However, if the jobs we are processing are CPU-intensive, we want to limit how many we are working on at one time.  To do this, we tell ActionHero to run somewhere between <!-- /react-text --><code data-reactid="432">minTaskProcessors</code><!-- react-text: 433 --> and <!-- /react-text --><code data-reactid="434">maxTaskProcessors</code><!-- react-text: 435 --> and check every so often if the server could be working more or less jobs at a time.  Depending on the response characteristics you want for your server, you can modify these values.<!-- /react-text --></p><p data-reactid="436"><!-- react-text: 437 -->In production, it is best to set up some ActionHero servers that only handle requests from clients (that is, servers with no TaskProcessors) and others that handle no requests, and only process jobs (that is, no servers, many <!-- /react-text --><code data-reactid="438">TaskProcessor</code><!-- react-text: 439 -->s).<!-- /react-text --></p><p data-reactid="440"><!-- react-text: 441 -->As you noticed above, when you enqueue a task, you tell it which queue to be enqueued within.  This is so you can separate load or priority.  For example, you might have a <!-- /react-text --><code data-reactid="442">high</code><!-- react-text: 443 --> priority queue which does jobs like &quot;sendPushMessage&quot; and a <!-- /react-text --><code data-reactid="444">low</code><!-- react-text: 445 --> priority queue which does a task like &quot;cleanupCache&quot;.  You tell the <!-- /react-text --><code data-reactid="446">taskProcessor</code><!-- react-text: 447 -->s which jobs to work, and in which priority. For the example above, you would ensure that all <!-- /react-text --><code data-reactid="448">high</code><!-- react-text: 449 --> jobs happen before all <!-- /react-text --><code data-reactid="450">low</code><!-- react-text: 451 --> jobs by setting: <!-- /react-text --><code data-reactid="452">api.config.tasks.queues = [&#x27;high&#x27;, &#x27;low&#x27;]</code><!-- react-text: 453 -->. You could also configure more nodes to work on the <!-- /react-text --><code data-reactid="454">high</code><!-- react-text: 455 --> queue than the <!-- /react-text --><code data-reactid="456">low</code><!-- react-text: 457 --> queue, thus further ensuring that <!-- /react-text --><code data-reactid="458">high</code><!-- react-text: 459 --> priority jobs are processed faster and sooner than <!-- /react-text --><code data-reactid="460">low</code><!-- react-text: 461 --> priority jobs.<!-- /react-text --></p></div></div></div><div data-reactid="462"><br data-reactid="463"/><h2 id="creating-a-task" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="464"><span style="font-weight:300;font-size:36px;" data-reactid="465">Creating a Task</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px;" data-reactid="466"/><div style="font-family:Open Sans, sans-serif;" data-reactid="467"><div data-reactid="468"><p data-reactid="469">An few ways to define a task:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8;" data-reactid="470"><code data-reactid="471"><span style="color:#998;font-style:italic;" data-reactid="472"><!-- react-text: 473 -->// define a single task in a file<!-- /react-text --></span><!-- react-text: 474 -->

<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="475"><!-- react-text: 476 -->var<!-- /react-text --></span><!-- react-text: 477 --> task = {
  <!-- /react-text --><span data-reactid="478"><!-- react-text: 479 -->name<!-- /react-text --></span><!-- react-text: 480 -->:          <!-- /react-text --><span style="color:#d14;" data-reactid="481"><!-- react-text: 482 -->&quot;sendWelcomeEmail&quot;<!-- /react-text --></span><!-- react-text: 483 -->,
  <!-- /react-text --><span data-reactid="484"><!-- react-text: 485 -->description<!-- /react-text --></span><!-- react-text: 486 -->:   <!-- /react-text --><span style="color:#d14;" data-reactid="487"><!-- react-text: 488 -->&quot;I will send a new user a welcome email&quot;<!-- /react-text --></span><!-- react-text: 489 -->,
  <!-- /react-text --><span data-reactid="490"><!-- react-text: 491 -->queue<!-- /react-text --></span><!-- react-text: 492 -->:         <!-- /react-text --><span style="color:#d14;" data-reactid="493"><!-- react-text: 494 -->&quot;default&quot;<!-- /react-text --></span><!-- react-text: 495 -->,
  <!-- /react-text --><span data-reactid="496"><!-- react-text: 497 -->plugins<!-- /react-text --></span><!-- react-text: 498 -->:       [],
  <!-- /react-text --><span data-reactid="499"><!-- react-text: 500 -->pluginOptions<!-- /react-text --></span><!-- react-text: 501 -->: [],
  <!-- /react-text --><span data-reactid="502"><!-- react-text: 503 -->frequency<!-- /react-text --></span><!-- react-text: 504 -->:     <!-- /react-text --><span style="color:#008080;" data-reactid="505"><!-- react-text: 506 -->0<!-- /react-text --></span><!-- react-text: 507 -->,
  <!-- /react-text --><span data-reactid="508"><!-- react-text: 509 -->run<!-- /react-text --></span><!-- react-text: 510 -->: <!-- /react-text --><span data-reactid="511"><span style="color:#333;font-weight:bold;" data-reactid="512"><!-- react-text: 513 -->function<!-- /react-text --></span><!-- react-text: 514 -->(<!-- /react-text --><span data-reactid="515"><!-- react-text: 516 -->api, params, next<!-- /react-text --></span><!-- react-text: 517 -->)<!-- /react-text --></span><!-- react-text: 518 -->{
    api.sendEmail(params.email, <!-- /react-text --><span data-reactid="519"><span style="color:#333;font-weight:bold;" data-reactid="520"><!-- react-text: 521 -->function<!-- /react-text --></span><!-- react-text: 522 -->(<!-- /react-text --><span data-reactid="523"><!-- react-text: 524 -->error<!-- /react-text --></span><!-- react-text: 525 -->)<!-- /react-text --></span><!-- react-text: 526 -->{
      next(error); <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="527"><!-- react-text: 528 -->//task will fail if sendEmail does<!-- /react-text --></span><!-- react-text: 529 -->
    })
  }
};

exports.task = task;

<!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="530"><!-- react-text: 531 -->// define multiple tasks (so you can share methods)<!-- /react-text --></span><!-- react-text: 532 -->

exports.sayHello = {
  <!-- /react-text --><span data-reactid="533"><!-- react-text: 534 -->name<!-- /react-text --></span><!-- react-text: 535 -->:          <!-- /react-text --><span style="color:#d14;" data-reactid="536"><!-- react-text: 537 -->&#x27;sayHello&#x27;<!-- /react-text --></span><!-- react-text: 538 -->,
  <!-- /react-text --><span data-reactid="539"><!-- react-text: 540 -->description<!-- /react-text --></span><!-- react-text: 541 -->:   <!-- /react-text --><span style="color:#d14;" data-reactid="542"><!-- react-text: 543 -->&#x27;I say hello&#x27;<!-- /react-text --></span><!-- react-text: 544 -->,
  <!-- /react-text --><span data-reactid="545"><!-- react-text: 546 -->queue<!-- /react-text --></span><!-- react-text: 547 -->:         <!-- /react-text --><span style="color:#d14;" data-reactid="548"><!-- react-text: 549 -->&quot;default&quot;<!-- /react-text --></span><!-- react-text: 550 -->,
  <!-- /react-text --><span data-reactid="551"><!-- react-text: 552 -->plugins<!-- /react-text --></span><!-- react-text: 553 -->:       [],
  <!-- /react-text --><span data-reactid="554"><!-- react-text: 555 -->pluginOptions<!-- /react-text --></span><!-- react-text: 556 -->: [],
  <!-- /react-text --><span data-reactid="557"><!-- react-text: 558 -->frequency<!-- /react-text --></span><!-- react-text: 559 -->:     <!-- /react-text --><span style="color:#008080;" data-reactid="560"><!-- react-text: 561 -->1000<!-- /react-text --></span><!-- react-text: 562 -->,
  <!-- /react-text --><span data-reactid="563"><!-- react-text: 564 -->run<!-- /react-text --></span><!-- react-text: 565 -->: <!-- /react-text --><span data-reactid="566"><span style="color:#333;font-weight:bold;" data-reactid="567"><!-- react-text: 568 -->function<!-- /react-text --></span><!-- react-text: 569 -->(<!-- /react-text --><span data-reactid="570"><!-- react-text: 571 -->api, params, next<!-- /react-text --></span><!-- react-text: 572 -->)<!-- /react-text --></span><!-- react-text: 573 -->{
    api.log(<!-- /react-text --><span style="color:#d14;" data-reactid="574"><!-- react-text: 575 -->&quot;hello&quot;<!-- /react-text --></span><!-- react-text: 576 -->)
    next();
  }
};

exports.sayGoodbye = {
  <!-- /react-text --><span data-reactid="577"><!-- react-text: 578 -->name<!-- /react-text --></span><!-- react-text: 579 -->:          <!-- /react-text --><span style="color:#d14;" data-reactid="580"><!-- react-text: 581 -->&#x27;sayGoodbye&#x27;<!-- /react-text --></span><!-- react-text: 582 -->,
  <!-- /react-text --><span data-reactid="583"><!-- react-text: 584 -->description<!-- /react-text --></span><!-- react-text: 585 -->:   <!-- /react-text --><span style="color:#d14;" data-reactid="586"><!-- react-text: 587 -->&#x27;I say goodbye&#x27;<!-- /react-text --></span><!-- react-text: 588 -->,
  <!-- /react-text --><span data-reactid="589"><!-- react-text: 590 -->queue<!-- /react-text --></span><!-- react-text: 591 -->:         <!-- /react-text --><span style="color:#d14;" data-reactid="592"><!-- react-text: 593 -->&quot;default&quot;<!-- /react-text --></span><!-- react-text: 594 -->,
  <!-- /react-text --><span data-reactid="595"><!-- react-text: 596 -->plugins<!-- /react-text --></span><!-- react-text: 597 -->:       [],
  <!-- /react-text --><span data-reactid="598"><!-- react-text: 599 -->pluginOptions<!-- /react-text --></span><!-- react-text: 600 -->: [],
  <!-- /react-text --><span data-reactid="601"><!-- react-text: 602 -->frequency<!-- /react-text --></span><!-- react-text: 603 -->:     <!-- /react-text --><span style="color:#008080;" data-reactid="604"><!-- react-text: 605 -->2000<!-- /react-text --></span><!-- react-text: 606 -->,
  <!-- /react-text --><span data-reactid="607"><!-- react-text: 608 -->run<!-- /react-text --></span><!-- react-text: 609 -->: <!-- /react-text --><span data-reactid="610"><span style="color:#333;font-weight:bold;" data-reactid="611"><!-- react-text: 612 -->function<!-- /react-text --></span><!-- react-text: 613 -->(<!-- /react-text --><span data-reactid="614"><!-- react-text: 615 -->api, params, next<!-- /react-text --></span><!-- react-text: 616 -->)<!-- /react-text --></span><!-- react-text: 617 -->{
    api.log(<!-- /react-text --><span style="color:#d14;" data-reactid="618"><!-- react-text: 619 -->&quot;goodbye&quot;<!-- /react-text --></span><!-- react-text: 620 -->)
    next();
  }
};<!-- /react-text --></code></pre><p data-reactid="621">Output of the above:</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8;" data-reactid="622"><code data-reactid="623"><span style="color:#998;font-style:italic;" data-reactid="624"><!-- react-text: 625 --># The output of running the last 2 tasks would be:<!-- /react-text --></span><!-- react-text: 626 -->

2013-11-28 15:21:56 - debug: resque scheduler working timestamp 1385680913
2013-11-28 15:21:56 - debug: resque scheduler enquing job 1385680913 class=sayHello, queue=default,
2013-11-28 15:21:56 - debug: resque scheduler working timestamp 1385680914
2013-11-28 15:21:56 - debug: resque scheduler enquing job 1385680914 class=sayGoodbye, queue=default,
2013-11-28 15:21:56 - debug: resque worker <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="627"><!-- react-text: 628 -->#1 working job default class=sayHello, queue=default,<!-- /react-text --></span><!-- react-text: 629 -->
2013-11-28 15:21:56 - info: hello
2013-11-28 15:21:56 - debug: re-enqueued reccurent job sayHello
2013-11-28 15:21:56 - debug: resque worker <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="630"><!-- react-text: 631 -->#1 working job default class=sayGoodbye, queue=default,<!-- /react-text --></span><!-- react-text: 632 -->
2013-11-28 15:21:56 - info: goodbye
2013-11-28 15:21:56 - debug: re-enqueued reccurent job sayGoodbye<!-- /react-text --></code></pre><p data-reactid="633"><!-- react-text: 634 -->You can create you own tasks by placing them in a <!-- /react-text --><code data-reactid="635">./tasks/</code><!-- react-text: 636 --> directory at the root of your application.  You can use the generator <!-- /react-text --><code data-reactid="637">actionhero generate task --name=myTask</code><!-- react-text: 638 -->. Like actions, all tasks have some required metadata:<!-- /react-text --></p><ul data-reactid="639"><li data-reactid="640"><code data-reactid="641">task.name</code><!-- react-text: 642 -->: The unique name of your task<!-- /react-text --></li><li data-reactid="643"><code data-reactid="644">task.description</code><!-- react-text: 645 -->: a description<!-- /react-text --></li><li data-reactid="646"><code data-reactid="647">task.queue</code><!-- react-text: 648 -->: the default queue to run this task within (can be overwritten when enqueued)<!-- /react-text --></li><li data-reactid="649"><code data-reactid="650">task.frequency</code><!-- react-text: 651 -->: In milliseconds, how often should I run?.  A frequency of &gt;0 denotes this task as periodic and ActionHero will automatically enqueued when the server boots.  Only one instance of a periodic task will be enqueued within the cluster at a time, regardless of how many ActionHero nodes are connected.<!-- /react-text --></li><li data-reactid="652"><code data-reactid="653">task.plugins</code><!-- react-text: 654 -->: You can use resque plugins in your task from the node-resque project.  Plugins modify how your tasks are enqueued.  For example, if you use the <!-- /react-text --><code data-reactid="655">queue-lock</code><!-- react-text: 656 --> plugin, only one instance of any job (with similar arguments) can be enqueued at a time.  You can learn more about plugins from the <!-- /react-text --><a href="https://github.com/taskrabbit/node-resque#plugins" data-reactid="657">node-resque project</a><!-- react-text: 658 -->.<!-- /react-text --></li><li data-reactid="659"><code data-reactid="660">task.pluginOptions</code><!-- react-text: 661 -->: a hash of options for the plugins<!-- /react-text --></li></ul><p data-reactid="662"><code data-reactid="663">task.run</code><!-- react-text: 664 --> contains the actual work that the task does. It takes the following arguments:<!-- /react-text --></p><ul data-reactid="665"><li data-reactid="666"><code data-reactid="667">api</code><!-- react-text: 668 -->: The ActionHero api object<!-- /react-text --></li><li data-reactid="669"><code data-reactid="670">params</code><!-- react-text: 671 -->: An array of parameters that the task was enqueued with. This is whatever was passed as the second argument to <!-- /react-text --><code data-reactid="672">api.tasks.enqueue</code></li><li data-reactid="673"><code data-reactid="674">next</code><!-- react-text: 675 -->: A callback to call when the task is done. This callback is of the type <!-- /react-text --><code data-reactid="676">function(error, result)</code><!-- react-text: 677 -->.<!-- /react-text --><ul data-reactid="678"><li data-reactid="679"><!-- react-text: 680 -->Passing an <!-- /react-text --><code data-reactid="681">error</code><!-- react-text: 682 --> object will cause the job to be marked as a failure.<!-- /react-text --></li><li data-reactid="683">The result is currently not captured anywhere.</li></ul></li></ul></div></div></div><div data-reactid="684"><br data-reactid="685"/><h2 id="queue-inspection" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="686"><span style="font-weight:300;font-size:36px;" data-reactid="687">Queue Inspection</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px;" data-reactid="688"/><div style="font-family:Open Sans, sans-serif;" data-reactid="689"><div data-reactid="690"><p data-reactid="691">ActionHero provides some methods to help inspect the state of your queue.  You can use these methods to check if your jobs are processing in a timely manner, if there are errors in task processing, etc.</p><h3 data-reactid="692"><code data-reactid="693">api.tasks.scheduledAt(queue, taskName, args, next)</code></h3><ul data-reactid="694"><li data-reactid="695"><code data-reactid="696">next(error, timestamps)</code></li><li data-reactid="697">finds all matching instances of queue + taskName + args from the delayed queues</li><li data-reactid="698">timestamps will be an array of the delayed timestamps</li></ul><h3 data-reactid="699"><code data-reactid="700">api.tasks.del(queue, taskName, args, count, next)</code></h3><ul data-reactid="701"><li data-reactid="702"><code data-reactid="703">next(error, count)</code></li><li data-reactid="704">removes all matching instances of queue + taskName + args from the normal queues</li><li data-reactid="705">count is how many instances of this task were removed</li></ul><h3 data-reactid="706"><code data-reactid="707">api.tasks.delDelayed(queue, taskName, args, next)</code></h3><ul data-reactid="708"><li data-reactid="709"><code data-reactid="710">next(error, timestamps)</code></li><li data-reactid="711">removes all matching instances of queue + taskName + args from the delayed queues</li><li data-reactid="712">timestamps will be an array of the delayed timestamps which the task was removed from</li></ul><h3 data-reactid="713"><code data-reactid="714">api.tasks.delQueue(queue, next)</code></h3><ul data-reactid="715"><li data-reactid="716"><code data-reactid="717">next(error)</code></li><li data-reactid="718">removes all jobs in a resque queue</li></ul><h3 data-reactid="719"><code data-reactid="720">api.tasks.enqueueRecurrentJob(taskName, next)</code></h3><ul data-reactid="721"><li data-reactid="722"><code data-reactid="723">next()</code></li><li data-reactid="724">will enqueue are recurring job</li><li data-reactid="725">might not actually enqueue the job if it is already enqueued due to resque plugins</li></ul><h3 data-reactid="726"><code data-reactid="727">api.tasks.stopRecurrentJob(taskName, next)</code></h3><ul data-reactid="728"><li data-reactid="729"><code data-reactid="730">next(error, removedCount)</code></li><li data-reactid="731"><!-- react-text: 732 -->will remove all instances of <!-- /react-text --><code data-reactid="733">taskName</code><!-- react-text: 734 --> from the delayed queues and normal queues<!-- /react-text --></li><li data-reactid="735">removedCount will inform you of how many instances of this job were removed</li></ul><h3 data-reactid="736"><code data-reactid="737">api.tasks.timestamps(next)</code></h3><ul data-reactid="738"><li data-reactid="739"><code data-reactid="740">next(error, timestamps)</code></li><li data-reactid="741">will return an array of all timesamps which have at least one job scheduled to be run</li><li data-reactid="742"><!-- react-text: 743 -->for use with <!-- /react-text --><code data-reactid="744">api.tasks.delayedAt</code></li></ul><h3 data-reactid="745"><code data-reactid="746">api.tasks.queued(q, start, stop, next)</code></h3><ul data-reactid="747"><li data-reactid="748"><code data-reactid="749">next(error, jobs)</code></li><li data-reactid="750">will return an array of all pending jobs in a resque queue (paginated via start/stop)</li></ul><h3 data-reactid="751"><code data-reactid="752">api.tasks.stats(next)</code></h3><ul data-reactid="753"><li data-reactid="754"><code data-reactid="755">next(error, stats)</code></li><li data-reactid="756">will return an array of all stats from your resque cluster</li></ul><h3 data-reactid="757"><code data-reactid="758">api.tasks.locks(next)</code></h3><ul data-reactid="759"><li data-reactid="760"><code data-reactid="761">next(error, locks)</code></li><li data-reactid="762">will return an array of all locks from your resque cluster (both queue and worker)</li></ul><h3 data-reactid="763"><code data-reactid="764">api.tasks.delLock(lockName, next)</code></h3><ul data-reactid="765"><li data-reactid="766"><code data-reactid="767">next(error, count)</code></li><li data-reactid="768">will return the count of locks deleted (if any)</li></ul><h3 data-reactid="769"><code data-reactid="770">api.tasks.delayedAt(timestamp, next)</code></h3><ul data-reactid="771"><li data-reactid="772"><code data-reactid="773">next(error, jobs)</code></li><li data-reactid="774">will return the list of jobs enqueued to run after this timestamp</li></ul><h3 data-reactid="775"><code data-reactid="776">api.tasks.allDelayed(next)</code></h3><ul data-reactid="777"><li data-reactid="778"><code data-reactid="779">next(error, jobs)</code></li><li data-reactid="780">will return the list of all jobs enqueued by the timestamp they are enqueued to run at</li></ul><h3 data-reactid="781"><code data-reactid="782">api.tasks.workers(next)</code></h3><ul data-reactid="783"><li data-reactid="784">next(error, workers)</li><li data-reactid="785">list all taskProcessors</li></ul><h3 data-reactid="786"><code data-reactid="787">api.tasks.workingOn(workerName, queues, next)</code></h3><ul data-reactid="788"><li data-reactid="789"><code data-reactid="790">next(error, status)</code></li><li data-reactid="791">list what a specific taskProcessors (defined by the name of the server + queues) is working on (or sleeping)</li></ul><h3 data-reactid="792"><code data-reactid="793">api.tasks.allWorkingOn(next)</code></h3><ul data-reactid="794"><li data-reactid="795"><code data-reactid="796">next(error, workers)</code></li><li data-reactid="797">list what all taskProcessors are working on (or sleeping)</li></ul><h3 data-reactid="798"><code data-reactid="799">api.tasks.details(next)</code></h3><ul data-reactid="800"><li data-reactid="801"><code data-reactid="802">next(error, details)</code></li><li data-reactid="803">details is a hash of all the queues in the system and how long they are</li><li data-reactid="804">this method also returns metadata about the taskProcessors and what they are currently working on</li></ul><h3 data-reactid="805"><code data-reactid="806">api.tasks.failedCount(next)</code></h3><ul data-reactid="807"><li data-reactid="808"><code data-reactid="809">next(error, failedCount)</code></li><li data-reactid="810"><code data-reactid="811">failedCount</code><!-- react-text: 812 --> is how many resque jobs are in the failed queue.<!-- /react-text --></li></ul><h3 data-reactid="813"><code data-reactid="814">api.tasks.failed(start, stop, next)</code></h3><ul data-reactid="815"><li data-reactid="816"><code data-reactid="817">next(error, failedJobs)</code></li><li data-reactid="818"><code data-reactid="819">failedJobs</code><!-- react-text: 820 --> is an array listing the data of the failed jobs.  You can see an example at <!-- /react-text --><a href="https://github.com/taskrabbit/node-resque#failed-job-managment" data-reactid="821">https://github.com/taskrabbit/node-resque#failed-job-managment</a></li></ul><h3 data-reactid="822"><code data-reactid="823">api.tasks.removeFailed(failedJob, next)</code></h3><ul data-reactid="824"><li data-reactid="825"><code data-reactid="826">next(error, removedCount)</code></li><li data-reactid="827"><!-- react-text: 828 -->the input <!-- /react-text --><code data-reactid="829">failedJob</code><!-- react-text: 830 --> is an expanded node object representing the failed job, retrieved via <!-- /react-text --><code data-reactid="831">api.tasks.failed</code></li></ul><h3 data-reactid="832"><code data-reactid="833">api.tasks.retryAndRemoveFailed(failedJob, next)</code></h3><ul data-reactid="834"><li data-reactid="835"><code data-reactid="836">next(error, failedJob)</code></li><li data-reactid="837"><!-- react-text: 838 -->the error <!-- /react-text --><code data-reactid="839">failedJob</code><!-- react-text: 840 --> is an expanded node object representing the failed job, retrieved via <!-- /react-text --><code data-reactid="841">api.tasks.failed</code></li></ul></div></div></div><div data-reactid="842"><br data-reactid="843"/><h2 id="job-schedules" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="844"><span style="font-weight:300;font-size:36px;" data-reactid="845">Job Schedules</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px;" data-reactid="846"/><div style="font-family:Open Sans, sans-serif;" data-reactid="847"><div data-reactid="848"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8;" data-reactid="849"><code data-reactid="850"><span style="color:#998;font-style:italic;" data-reactid="851"><!-- react-text: 852 -->// file: initializers/node_schedule.js<!-- /react-text --></span><!-- react-text: 853 -->

<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="854"><!-- react-text: 855 -->var<!-- /react-text --></span><!-- react-text: 856 --> schedule = <!-- /react-text --><span style="color:#0086b3;" data-reactid="857"><!-- react-text: 858 -->require<!-- /react-text --></span><!-- react-text: 859 -->(<!-- /react-text --><span style="color:#d14;" data-reactid="860"><!-- react-text: 861 -->&#x27;node-schedule&#x27;<!-- /react-text --></span><!-- react-text: 862 -->);

<!-- /react-text --><span style="color:#0086b3;" data-reactid="863"><!-- react-text: 864 -->module<!-- /react-text --></span><!-- react-text: 865 -->.exports = {
  <!-- /react-text --><span data-reactid="866"><!-- react-text: 867 -->initialize<!-- /react-text --></span><!-- react-text: 868 -->: <!-- /react-text --><span data-reactid="869"><span style="color:#333;font-weight:bold;" data-reactid="870"><!-- react-text: 871 -->function<!-- /react-text --></span><!-- react-text: 872 -->(<!-- /react-text --><span data-reactid="873"><!-- react-text: 874 -->api, next<!-- /react-text --></span><!-- react-text: 875 -->)<!-- /react-text --></span><!-- react-text: 876 -->{
    api.scheduledJobs = [];
    next();
  },

  <!-- /react-text --><span data-reactid="877"><!-- react-text: 878 -->start<!-- /react-text --></span><!-- react-text: 879 -->: <!-- /react-text --><span data-reactid="880"><span style="color:#333;font-weight:bold;" data-reactid="881"><!-- react-text: 882 -->function<!-- /react-text --></span><!-- react-text: 883 -->(<!-- /react-text --><span data-reactid="884"><!-- react-text: 885 -->api, next<!-- /react-text --></span><!-- react-text: 886 -->)<!-- /react-text --></span><!-- react-text: 887 -->{

    <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="888"><!-- react-text: 889 -->// do this job every 10 seconds, cron style<!-- /react-text --></span><!-- react-text: 890 -->
    <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="891"><!-- react-text: 892 -->var<!-- /react-text --></span><!-- react-text: 893 --> job = schedule.scheduleJob(<!-- /react-text --><span style="color:#d14;" data-reactid="894"><!-- react-text: 895 -->&#x27;0,10,20,30,40,50 * * * * *&#x27;<!-- /react-text --></span><!-- react-text: 896 -->, <!-- /react-text --><span data-reactid="897"><span style="color:#333;font-weight:bold;" data-reactid="898"><!-- react-text: 899 -->function<!-- /react-text --></span><!-- react-text: 900 -->(<!-- /react-text --><span data-reactid="901"></span><!-- react-text: 902 -->)<!-- /react-text --></span><!-- react-text: 903 -->{
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="904"><!-- react-text: 905 -->// we want to ensure that only one instance of this job is scheduled in our environment at once,<!-- /react-text --></span><!-- react-text: 906 -->
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="907"><!-- react-text: 908 -->// no matter how many schedulers we have running<!-- /react-text --></span><!-- react-text: 909 -->

      <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="910"><!-- react-text: 911 -->if<!-- /react-text --></span><!-- react-text: 912 -->(api.resque.scheduler &amp;&amp; api.resque.scheduler.master){
        api.tasks.enqueue(<!-- /react-text --><span style="color:#d14;" data-reactid="913"><!-- react-text: 914 -->&#x27;sayHello&#x27;<!-- /react-text --></span><!-- react-text: 915 -->, {<!-- /react-text --><span data-reactid="916"><!-- react-text: 917 -->time<!-- /react-text --></span><!-- react-text: 918 -->: <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="919"><!-- react-text: 920 -->new<!-- /react-text --></span><!-- react-text: 921 --> <!-- /react-text --><span style="color:#0086b3;" data-reactid="922"><!-- react-text: 923 -->Date<!-- /react-text --></span><!-- react-text: 924 -->().toString()}, <!-- /react-text --><span style="color:#d14;" data-reactid="925"><!-- react-text: 926 -->&#x27;default&#x27;<!-- /react-text --></span><!-- react-text: 927 -->, <!-- /react-text --><span data-reactid="928"><span style="color:#333;font-weight:bold;" data-reactid="929"><!-- react-text: 930 -->function<!-- /react-text --></span><!-- react-text: 931 -->(<!-- /react-text --><span data-reactid="932"><!-- react-text: 933 -->error<!-- /react-text --></span><!-- react-text: 934 -->)<!-- /react-text --></span><!-- react-text: 935 -->{
          <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="936"><!-- react-text: 937 -->if<!-- /react-text --></span><!-- react-text: 938 -->(error){ api.log(error, <!-- /react-text --><span style="color:#d14;" data-reactid="939"><!-- react-text: 940 -->&#x27;error&#x27;<!-- /react-text --></span><!-- react-text: 941 -->); }
        });
      }
    });

    api.scheduledJobs.push(job);

    next();
  },

  <!-- /react-text --><span data-reactid="942"><!-- react-text: 943 -->stop<!-- /react-text --></span><!-- react-text: 944 -->: <!-- /react-text --><span data-reactid="945"><span style="color:#333;font-weight:bold;" data-reactid="946"><!-- react-text: 947 -->function<!-- /react-text --></span><!-- react-text: 948 -->(<!-- /react-text --><span data-reactid="949"><!-- react-text: 950 -->api, next<!-- /react-text --></span><!-- react-text: 951 -->)<!-- /react-text --></span><!-- react-text: 952 -->{
    api.scheduledJobs.forEach(<!-- /react-text --><span data-reactid="953"><span style="color:#333;font-weight:bold;" data-reactid="954"><!-- react-text: 955 -->function<!-- /react-text --></span><!-- react-text: 956 -->(<!-- /react-text --><span data-reactid="957"><!-- react-text: 958 -->job<!-- /react-text --></span><!-- react-text: 959 -->)<!-- /react-text --></span><!-- react-text: 960 -->{
      job.canel();
    });

    next();
  }
};<!-- /react-text --></code></pre><p data-reactid="961"><!-- react-text: 962 -->You may want to schedule jobs every minute/hour/day, like a distributed CRON job.  There are a number of excellent node packages to help you with this, like <!-- /react-text --><a href="https://github.com/tejasmanohar/node-schedule" data-reactid="963">node-schedule</a><!-- react-text: 964 --> and <!-- /react-text --><a href="https://github.com/ncb000gt/node-cron" data-reactid="965">node-cron</a><!-- react-text: 966 -->.  ActionHero exposes <!-- /react-text --><a href="https://github.com/taskrabbit/node-resque" data-reactid="967">node-resque&#x27;s</a><!-- react-text: 968 --> scheduler to you so you can use the scheduler package of your choice.<!-- /react-text --></p><p data-reactid="969"><!-- react-text: 970 -->Assuming you are running ActionHero across multiple machines, you will need to ensure that only one of your processes is actually scheduling the jobs.  To help you with this, you can inspect which of the scheduler processes is correctly acting as master, and flag only the master scheduler process to run the schedule.  An <!-- /react-text --><a href="/docs/core/#initializers" data-reactid="971">initializer for this</a><!-- react-text: 972 --> would look like:<!-- /react-text --></p><p data-reactid="973">Be sure to have the scheduler enabled on at least one of your ActionHero servers!</p></div></div></div><div data-reactid="974"><br data-reactid="975"/><h2 id="failed-job-management" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="976"><span style="font-weight:300;font-size:36px;" data-reactid="977">Failed Job Management</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px;" data-reactid="978"/><div style="font-family:Open Sans, sans-serif;" data-reactid="979"><div data-reactid="980"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8;" data-reactid="981"><code data-reactid="982"><span style="color:#333;font-weight:bold;" data-reactid="983"><!-- react-text: 984 -->var<!-- /react-text --></span><!-- react-text: 985 --> removeStuckWorkersOlderThan = <!-- /react-text --><span style="color:#008080;" data-reactid="986"><!-- react-text: 987 -->10000<!-- /react-text --></span><!-- react-text: 988 -->; <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="989"><!-- react-text: 990 -->// 10000ms<!-- /react-text --></span><!-- react-text: 991 -->
api.log(<!-- /react-text --><span style="color:#d14;" data-reactid="992"><!-- react-text: 993 -->&#x27;removing stuck workers solder than &#x27;<!-- /react-text --></span><!-- react-text: 994 --> + removeStuckWorkersOlderThan + <!-- /react-text --><span style="color:#d14;" data-reactid="995"><!-- react-text: 996 -->&#x27;ms&#x27;<!-- /react-text --></span><!-- react-text: 997 -->, <!-- /react-text --><span style="color:#d14;" data-reactid="998"><!-- react-text: 999 -->&#x27;info&#x27;<!-- /react-text --></span><!-- react-text: 1000 -->);
api.tasks.cleanOldWorkers(removeStuckWorkersOlderThan, <!-- /react-text --><span data-reactid="1001"><span style="color:#333;font-weight:bold;" data-reactid="1002"><!-- react-text: 1003 -->function<!-- /react-text --></span><!-- react-text: 1004 -->(<!-- /react-text --><span data-reactid="1005"><!-- react-text: 1006 -->error, result<!-- /react-text --></span><!-- react-text: 1007 -->)<!-- /react-text --></span><!-- react-text: 1008 -->{
  <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1009"><!-- react-text: 1010 -->if<!-- /react-text --></span><!-- react-text: 1011 -->(error){
    api.log(error, <!-- /react-text --><span style="color:#d14;" data-reactid="1012"><!-- react-text: 1013 -->&#x27;error&#x27;<!-- /react-text --></span><!-- react-text: 1014 -->);
  }
  <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1015"><!-- react-text: 1016 -->if<!-- /react-text --></span><!-- react-text: 1017 -->(<!-- /react-text --><span style="color:#0086b3;" data-reactid="1018"><!-- react-text: 1019 -->Object<!-- /react-text --></span><!-- react-text: 1020 -->.keys(result).length &gt; <!-- /react-text --><span style="color:#008080;" data-reactid="1021"><!-- react-text: 1022 -->0<!-- /react-text --></span><!-- react-text: 1023 -->){
    api.log(<!-- /react-text --><span style="color:#d14;" data-reactid="1024"><!-- react-text: 1025 -->&#x27;removed stuck workers with errors: &#x27;<!-- /react-text --></span><!-- react-text: 1026 -->, <!-- /react-text --><span style="color:#d14;" data-reactid="1027"><!-- react-text: 1028 -->&#x27;info&#x27;<!-- /react-text --></span><!-- react-text: 1029 -->, result);
  }
  callback();
});<!-- /react-text --></code></pre><p data-reactid="1030"><!-- react-text: 1031 -->Sometimes a worker crashes is a severe way, and it doesn&#x27;t get the time/chance to notify redis that it is leaving the pool (this happens all the time on PAAS providers like Heroku). When this happens, you will not only need to extract the job from the now-zombie worker&#x27;s &quot;working on&quot; status, but also remove the stuck worker. To aid you in these edge cases, <!-- /react-text --><code data-reactid="1032">api.tasks.cleanOldWorkers(age, callback)</code><!-- react-text: 1033 --> is available.<!-- /react-text --></p><p data-reactid="1034"><!-- react-text: 1035 -->Because there are no &#x27;heartbeats&#x27; in resque, it is impossible for the application to know if a worker has been working on a long job or it is dead. You are required to provide an &quot;age&quot; for how long a worker has been &quot;working&quot;, and all those older than that age will be removed, and the job they are working on moved to the error queue (where you can then use <!-- /react-text --><code data-reactid="1036">api.tasks.retryAndRemoveFailed</code><!-- react-text: 1037 -->) to re-enqueue the job.<!-- /react-text --></p><p data-reactid="1038">You can handle this with an own initializer and the following logic =&gt;</p></div></div></div><div data-reactid="1039"><br data-reactid="1040"/><h2 id="extending-resque" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="1041"><span style="font-weight:300;font-size:36px;" data-reactid="1042">Extending Resque</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px;" data-reactid="1043"/><div style="font-family:Open Sans, sans-serif;" data-reactid="1044"><div data-reactid="1045"><p data-reactid="1046">In cases where you would like to extend or modify the underlying behaviour or capabilities of Resque you can specify replacements for the Queues, Scheduler, or Multi Worker implementations in the Tasks configuration.</p><pre style="display:block;overflow-x:auto;padding:0.5em;color:#333;background:#f8f8f8;" data-reactid="1047"><code data-reactid="1048"><span style="color:#998;font-style:italic;" data-reactid="1049"><!-- react-text: 1050 -->// From /config/tasks.js:<!-- /react-text --></span><!-- react-text: 1051 -->
<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1052"><!-- react-text: 1053 -->var<!-- /react-text --></span><!-- react-text: 1054 --> myQueue = <!-- /react-text --><span style="color:#0086b3;" data-reactid="1055"><!-- react-text: 1056 -->require<!-- /react-text --></span><!-- react-text: 1057 -->(<!-- /react-text --><span style="color:#d14;" data-reactid="1058"><!-- react-text: 1059 -->&#x27;../util/myQueue.js&#x27;<!-- /react-text --></span><!-- react-text: 1060 -->);

exports.default = {
  <!-- /react-text --><span data-reactid="1061"><!-- react-text: 1062 -->tasks<!-- /react-text --></span><!-- react-text: 1063 -->: <!-- /react-text --><span data-reactid="1064"><span style="color:#333;font-weight:bold;" data-reactid="1065"><!-- react-text: 1066 -->function<!-- /react-text --></span><!-- react-text: 1067 -->(<!-- /react-text --><span data-reactid="1068"><!-- react-text: 1069 -->api<!-- /react-text --></span><!-- react-text: 1070 -->)<!-- /react-text --></span><!-- react-text: 1071 -->{
    <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1072"><!-- react-text: 1073 -->return<!-- /react-text --></span><!-- react-text: 1074 --> {
      ...
      <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="1075"><!-- react-text: 1076 -->// Customize Resque primitives, replace null with required replacement.<!-- /react-text --></span><!-- react-text: 1077 -->
      resque_overrides: {
        <!-- /react-text --><span data-reactid="1078"><!-- react-text: 1079 -->queue<!-- /react-text --></span><!-- react-text: 1080 -->: myQueue,  <!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="1081"><!-- react-text: 1082 -->//&lt;-- Explicitly pass replacement Queue implementation<!-- /react-text --></span><!-- react-text: 1083 -->
        multiWorker: <!-- /react-text --><span style="color:#008080;" data-reactid="1084"><!-- react-text: 1085 -->null<!-- /react-text --></span><!-- react-text: 1086 -->,
        <!-- /react-text --><span data-reactid="1087"><!-- react-text: 1088 -->scheduler<!-- /react-text --></span><!-- react-text: 1089 -->: <!-- /react-text --><span style="color:#008080;" data-reactid="1090"><!-- react-text: 1091 -->null<!-- /react-text --></span><!-- react-text: 1092 -->
      }
    }
  }
}

<!-- /react-text --><span style="color:#998;font-style:italic;" data-reactid="1093"><!-- react-text: 1094 -->//From util/myQueue.js:<!-- /react-text --></span><!-- react-text: 1095 -->
<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1096"><!-- react-text: 1097 -->var<!-- /react-text --></span><!-- react-text: 1098 --> NR = <!-- /react-text --><span style="color:#0086b3;" data-reactid="1099"><!-- react-text: 1100 -->require<!-- /react-text --></span><!-- react-text: 1101 -->(<!-- /react-text --><span style="color:#d14;" data-reactid="1102"><!-- react-text: 1103 -->&#x27;node-resque&#x27;<!-- /react-text --></span><!-- react-text: 1104 -->);
<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1105"><!-- react-text: 1106 -->var<!-- /react-text --></span><!-- react-text: 1107 --> pluginRunner = <!-- /react-text --><span style="color:#0086b3;" data-reactid="1108"><!-- react-text: 1109 -->require<!-- /react-text --></span><!-- react-text: 1110 -->(<!-- /react-text --><span style="color:#d14;" data-reactid="1111"><!-- react-text: 1112 -->&#x27;../node_modules/node-resque/lib/pluginRunner.js&#x27;<!-- /react-text --></span><!-- react-text: 1113 -->);

<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1114"><!-- react-text: 1115 -->let<!-- /react-text --></span><!-- react-text: 1116 --> myQueue = NR.queue;

myQueue.prototype.enqueueFront = <!-- /react-text --><span data-reactid="1117"><span style="color:#333;font-weight:bold;" data-reactid="1118"><!-- react-text: 1119 -->function<!-- /react-text --></span><!-- react-text: 1120 -->(<!-- /react-text --><span data-reactid="1121"><!-- react-text: 1122 -->q, func, args, callback<!-- /react-text --></span><!-- react-text: 1123 -->)<!-- /react-text --></span><!-- react-text: 1124 -->{
  <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1125"><!-- react-text: 1126 -->var<!-- /react-text --></span><!-- react-text: 1127 --> self = <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1128"><!-- react-text: 1129 -->this<!-- /react-text --></span><!-- react-text: 1130 -->;
  <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1131"><!-- react-text: 1132 -->if<!-- /react-text --></span><!-- react-text: 1133 -->(<!-- /react-text --><span style="color:#0086b3;" data-reactid="1134"><!-- react-text: 1135 -->arguments<!-- /react-text --></span><!-- react-text: 1136 -->.length === <!-- /react-text --><span style="color:#008080;" data-reactid="1137"><!-- react-text: 1138 -->3<!-- /react-text --></span><!-- react-text: 1139 --> &amp;&amp; <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1140"><!-- react-text: 1141 -->typeof<!-- /react-text --></span><!-- react-text: 1142 --> args === <!-- /react-text --><span style="color:#d14;" data-reactid="1143"><!-- react-text: 1144 -->&#x27;function&#x27;<!-- /react-text --></span><!-- react-text: 1145 -->){
   callback = args;
   args = [];
  }<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1146"><!-- react-text: 1147 -->else<!-- /react-text --></span><!-- react-text: 1148 --> <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1149"><!-- react-text: 1150 -->if<!-- /react-text --></span><!-- react-text: 1151 -->(<!-- /react-text --><span style="color:#0086b3;" data-reactid="1152"><!-- react-text: 1153 -->arguments<!-- /react-text --></span><!-- react-text: 1154 -->.length &lt; <!-- /react-text --><span style="color:#008080;" data-reactid="1155"><!-- react-text: 1156 -->3<!-- /react-text --></span><!-- react-text: 1157 -->){
   args = [];
  }

  args = arrayify(args);
  <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1158"><!-- react-text: 1159 -->var<!-- /react-text --></span><!-- react-text: 1160 --> job = self.jobs[func];
  pluginRunner.runPlugins(self, <!-- /react-text --><span style="color:#d14;" data-reactid="1161"><!-- react-text: 1162 -->&#x27;before_enqueue&#x27;<!-- /react-text --></span><!-- react-text: 1163 -->, func, q, job, args, <!-- /react-text --><span data-reactid="1164"><span style="color:#333;font-weight:bold;" data-reactid="1165"><!-- react-text: 1166 -->function<!-- /react-text --></span><!-- react-text: 1167 -->(<!-- /react-text --><span data-reactid="1168"><!-- react-text: 1169 -->err, toRun<!-- /react-text --></span><!-- react-text: 1170 -->)<!-- /react-text --></span><!-- react-text: 1171 -->{
   <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1172"><!-- react-text: 1173 -->if<!-- /react-text --></span><!-- react-text: 1174 -->(toRun === <!-- /react-text --><span style="color:#008080;" data-reactid="1175"><!-- react-text: 1176 -->false<!-- /react-text --></span><!-- react-text: 1177 -->){
     <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1178"><!-- react-text: 1179 -->if<!-- /react-text --></span><!-- react-text: 1180 -->(<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1181"><!-- react-text: 1182 -->typeof<!-- /react-text --></span><!-- react-text: 1183 --> callback === <!-- /react-text --><span style="color:#d14;" data-reactid="1184"><!-- react-text: 1185 -->&#x27;function&#x27;<!-- /react-text --></span><!-- react-text: 1186 -->){ callback(err, toRun); }
   }<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1187"><!-- react-text: 1188 -->else<!-- /react-text --></span><!-- react-text: 1189 -->{
     self.connection.redis.sadd(self.connection.key(<!-- /react-text --><span style="color:#d14;" data-reactid="1190"><!-- react-text: 1191 -->&#x27;queues&#x27;<!-- /react-text --></span><!-- react-text: 1192 -->), q, <!-- /react-text --><span data-reactid="1193"><span style="color:#333;font-weight:bold;" data-reactid="1194"><!-- react-text: 1195 -->function<!-- /react-text --></span><!-- react-text: 1196 -->(<!-- /react-text --><span data-reactid="1197"></span><!-- react-text: 1198 -->)<!-- /react-text --></span><!-- react-text: 1199 -->{
       self.connection.redis.lpush(self.connection.key(<!-- /react-text --><span style="color:#d14;" data-reactid="1200"><!-- react-text: 1201 -->&#x27;queue&#x27;<!-- /react-text --></span><!-- react-text: 1202 -->, q), self.encode(q, func, args), <!-- /react-text --><span data-reactid="1203"><span style="color:#333;font-weight:bold;" data-reactid="1204"><!-- react-text: 1205 -->function<!-- /react-text --></span><!-- react-text: 1206 -->(<!-- /react-text --><span data-reactid="1207"></span><!-- react-text: 1208 -->)<!-- /react-text --></span><!-- react-text: 1209 -->{
         pluginRunner.runPlugins(self, <!-- /react-text --><span style="color:#d14;" data-reactid="1210"><!-- react-text: 1211 -->&#x27;after_enqueue&#x27;<!-- /react-text --></span><!-- react-text: 1212 -->, func, q, job, args, <!-- /react-text --><span data-reactid="1213"><span style="color:#333;font-weight:bold;" data-reactid="1214"><!-- react-text: 1215 -->function<!-- /react-text --></span><!-- react-text: 1216 -->(<!-- /react-text --><span data-reactid="1217"></span><!-- react-text: 1218 -->)<!-- /react-text --></span><!-- react-text: 1219 -->{
           <!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1220"><!-- react-text: 1221 -->if<!-- /react-text --></span><!-- react-text: 1222 -->(<!-- /react-text --><span style="color:#333;font-weight:bold;" data-reactid="1223"><!-- react-text: 1224 -->typeof<!-- /react-text --></span><!-- react-text: 1225 --> callback === <!-- /react-text --><span style="color:#d14;" data-reactid="1226"><!-- react-text: 1227 -->&#x27;function&#x27;<!-- /react-text --></span><!-- react-text: 1228 -->){ callback(err, toRun); }
         });
       });
     });
   }
  });
};

<!-- /react-text --><span style="color:#0086b3;" data-reactid="1229"><!-- react-text: 1230 -->module<!-- /react-text --></span><!-- react-text: 1231 -->.exports = myQueue;<!-- /react-text --></code></pre><p data-reactid="1232"><!-- react-text: 1233 -->The above example will give you access to <!-- /react-text --><code data-reactid="1234">api.resque.queue.enqueueFront()</code><!-- react-text: 1235 -->, which you could use directly or wrap by extending the <!-- /react-text --><code data-reactid="1236">api.tasks</code><!-- react-text: 1237 --> object.<!-- /react-text --></p></div></div></div><div data-reactid="1238"><br data-reactid="1239"/><h2 id="notes" style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="1240"><span style="font-weight:300;font-size:36px;" data-reactid="1241">Notes</span></h2><hr style="color:#E14E3A;background-color:#E14E3A;border:0;height:2px;" data-reactid="1242"/><div style="font-family:Open Sans, sans-serif;" data-reactid="1243"><div data-reactid="1244"><p data-reactid="1245"><!-- react-text: 1246 -->Note that the <!-- /react-text --><code data-reactid="1247">frequency</code><!-- react-text: 1248 -->, <!-- /react-text --><code data-reactid="1249">enqueueIn</code><!-- react-text: 1250 --> and <!-- /react-text --><code data-reactid="1251">enqueueAt</code><!-- react-text: 1252 --> times are when a task is <!-- /react-text --><strong data-reactid="1253">allowed</strong><!-- react-text: 1254 --> to run, not when it <!-- /react-text --><strong data-reactid="1255">will</strong><!-- react-text: 1256 --> run.  TaskProcessors will work tasks in a first-in-first-out manner.  TaskProcessors also <!-- /react-text --><code data-reactid="1257">sleep</code><!-- react-text: 1258 --> when there is no work to do, and will take some time (default 5 seconds) to wake up and check for more work to do.<!-- /react-text --></p><p data-reactid="1259"><!-- react-text: 1260 -->Remember that each ActionHero server uses one thread and one event loop, so that if you have computationally intensive task (like computing Fibonacci numbers), this <!-- /react-text --><strong data-reactid="1261">will</strong><!-- react-text: 1262 --> block tasks, actions, and clients from working.  However, if your tasks are meant to communicate with external services (reading from a database, sending an email, etc), then these are perfect candidates to be run simultaneously as the single thread can work on other things while waiting for these operations to complete.<!-- /react-text --></p><p data-reactid="1263">Tasks are stored in redis.  Be sure to enable non-fake redis if you want your tasks to persist and be shared across more than one ActionHero server.</p><p data-reactid="1264">If you are running a single ActionHero server, all tasks will be run locally.  As you add more servers, the work will be split evenly across all nodes.  It is very likely that your job will be run on different nodes each time.</p></div></div></div></div></div></div><div class="hidden-xs hidden-sm col-md-3" data-reactid="1265"><div style="height:0;" data-reactid="1266"><div data-reactid="1267"><div data-reactid="1268"></div><div style="padding-top:90px;" class="" data-reactid="1269"><div data-reactid="1270"><!-- react-empty: 1271 --><div class="ais-InstantSearch__root" data-reactid="1272"><form novalidate="" class="ais-SearchBox__root" action="" role="search" data-reactid="1273"><svg xmlns="http://www.w3.org/2000/svg" style="display:none;" data-reactid="1274"><symbol xmlns="http://www.w3.org/2000/svg" id="sbx-icon-search-13" viewBox="0 0 40 40" data-reactid="1275"><path d="M26.804 29.01c-2.832 2.34-6.465 3.746-10.426 3.746C7.333 32.756 0 25.424 0 16.378 0 7.333 7.333 0 16.378 0c9.046 0 16.378 7.333 16.378 16.378 0 3.96-1.406 7.594-3.746 10.426l10.534 10.534c.607.607.61 1.59-.004 2.202-.61.61-1.597.61-2.202.004L26.804 29.01zm-10.426.627c7.323 0 13.26-5.936 13.26-13.26 0-7.32-5.937-13.257-13.26-13.257C9.056 3.12 3.12 9.056 3.12 16.378c0 7.323 5.936 13.26 13.258 13.26z" fill-rule="evenodd" data-reactid="1276"></path></symbol><symbol xmlns="http://www.w3.org/2000/svg" id="sbx-icon-clear-3" viewBox="0 0 20 20" data-reactid="1277"><path d="M8.114 10L.944 2.83 0 1.885 1.886 0l.943.943L10 8.113l7.17-7.17.944-.943L20 1.886l-.943.943-7.17 7.17 7.17 7.17.943.944L18.114 20l-.943-.943-7.17-7.17-7.17 7.17-.944.943L0 18.114l.943-.943L8.113 10z" fill-rule="evenodd" data-reactid="1278"></path></symbol></svg><div role="search" class="ais-SearchBox__wrapper" data-reactid="1279"><input type="search" placeholder="Search here…" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" required="" value="" class="ais-SearchBox__input" data-reactid="1280"/><button type="submit" title="Submit your search query." class="ais-SearchBox__submit" data-reactid="1281"><svg role="img" width="1em" height="1em" data-reactid="1282"><use xlink:href="#sbx-icon-search-13" data-reactid="1283"></use></svg></button><button type="reset" title="Clear the search query." class="ais-SearchBox__reset" data-reactid="1284"><svg role="img" width="1em" height="1em" data-reactid="1285"><use xlink:href="#sbx-icon-clear-3" data-reactid="1286"></use></svg></button></div></form><div class="ais-Hits__root" data-reactid="1287"></div></div><br data-reactid="1288"/></div><ul style="list-style-type:none;padding-left:0;margin-left:0;" data-reactid="1289"><li data-reactid="1290"><a href="#overview" class="text-info" style="font-weight:300;font-size:18px;line-height:1.6em;" data-reactid="1291">Overview</a></li><li data-reactid="1292"><a href="#enqueing" class="text-info" style="font-weight:300;font-size:18px;line-height:1.6em;" data-reactid="1293">Enqueing Tasks</a></li><li data-reactid="1294"><a href="#processing-tasks" class="text-info" style="font-weight:300;font-size:18px;line-height:1.6em;" data-reactid="1295">Processing Tasks</a></li><li data-reactid="1296"><a href="#creating-a-task" class="text-info" style="font-weight:300;font-size:18px;line-height:1.6em;" data-reactid="1297">Creating a Task</a></li><li data-reactid="1298"><a href="#queue-inspection" class="text-info" style="font-weight:300;font-size:18px;line-height:1.6em;" data-reactid="1299">Queue Inspection</a></li><li data-reactid="1300"><a href="#job-schedules" class="text-info" style="font-weight:300;font-size:18px;line-height:1.6em;" data-reactid="1301">Job Schedules</a></li><li data-reactid="1302"><a href="#failed-job-management" class="text-info" style="font-weight:300;font-size:18px;line-height:1.6em;" data-reactid="1303">Failed Job Management</a></li><li data-reactid="1304"><a href="#extending-resque" class="text-info" style="font-weight:300;font-size:18px;line-height:1.6em;" data-reactid="1305">Extending Resque</a></li><li data-reactid="1306"><a href="#notes" class="text-info" style="font-weight:300;font-size:18px;line-height:1.6em;" data-reactid="1307">Notes</a></li></ul><br data-reactid="1308"/><ul style="list-style-type:none;padding-left:0;margin-left:0;" data-reactid="1309"><div data-reactid="1310"><li data-reactid="1311"><a style="font-weight:200;color:#E14E3A;" href="/docs/core/middleware/" data-reactid="1312">» Core: Middleware</a></li><li data-reactid="1313"><a style="font-weight:200;color:#E14E3A;" href="/docs/core/actions/" data-reactid="1314">« Core: Actions</a></li></div><li data-reactid="1315"><a href="#_top" style="font-weight:200;color:#E14E3A;" data-reactid="1316">↑ Back to top</a></li></ul></div></div></div></div></div></div><div style="padding-bottom:100px;color:#2F5266;" data-reactid="1317"><div class="container" data-reactid="1318"><div class="row" data-reactid="1319"><div style="text-align:center;" class="col-md-12" data-reactid="1320"><hr style="color:#2F5266;background-color:#2F5266;border:0;height:2px;" data-reactid="1321"/><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="1322"><span style="font-weight:400;" data-reactid="1323">Up Next</span></h2><h2 style="font-family:Roboto, sans-serif;font-weight:300;font-size:20px;line-height:1.5em;color:#3B5D72;" data-reactid="1324"><a href="/docs/core/middleware/" data-reactid="1325">Core: Middleware</a></h2></div></div></div></div></div><div style="padding-left:0;padding-right:0;font-family:Roboto, sans-serif;font-size:14px;font-weight:300;" class="container-fluid" data-reactid="1326"><footer id="footer-container" style="background-color:#2F5266;color:#FBF9E4;font-family:Roboto, sans-serif;font-weight:200;" data-reactid="1327"><div class="container" data-reactid="1328"><div style="padding-bottom:50px;padding-top:50px;padding-left:100px;" class="row" data-reactid="1329"><div class="col-md-12" data-reactid="1330"><img src="/static/images/actionhero-logo-header-wordmark.svg" data-reactid="1331"/></div></div><div style="padding-bottom:100px;" class="row" data-reactid="1332"><div class="col-md-4" data-reactid="1333"><div style="padding-left:100px;" data-reactid="1334"><p data-reactid="1335"><a style="color:#FBF9E4;" href="/terms/" data-reactid="1336">Terms</a></p><p data-reactid="1337"><!-- react-text: 1338 -->Contact us at <!-- /react-text --><a style="color:#FBF9E4;font-weight:500;" href="mailto:hello@actionherojs.com" data-reactid="1339">hello@actionherojs.com</a></p><p data-reactid="1340"><a target="_new" style="color:#FBF9E4;" href="https://medium.com/tag/actionherojs/" data-reactid="1341">Blogs</a></p><p data-reactid="1342"><!-- react-text: 1343 -->© 2017<!-- /react-text --><!-- react-text: 1344 --> ActionHero<!-- /react-text --></p><p data-reactid="1345"><em data-reactid="1346"><!-- react-text: 1347 -->Search by <!-- /react-text --><a href="https://www.algolia.com" target="_new" data-reactid="1348"><!-- react-text: 1349 -->Algolia <!-- /react-text --><img style="padding:5px;" width="30" src="/static/images/algolia.svg" data-reactid="1350"/></a></em></p></div></div><div class="col-md-4" data-reactid="1351"><div style="padding-left:100px;" data-reactid="1352"><p data-reactid="1353"><a style="color:#FBF9E4;" href="/get-started/" data-reactid="1354">Get Started</a></p><p data-reactid="1355"><a style="color:#FBF9E4;" href="/docs/" data-reactid="1356">Documenation</a></p><p data-reactid="1357"><a style="color:#FBF9E4;" href="/solutions/" data-reactid="1358">Solutions</a></p><p data-reactid="1359"><a style="color:#FBF9E4;" href="/community/" data-reactid="1360">Community</a></p><p data-reactid="1361"><a style="color:#FBF9E4;" href="/downloads/" data-reactid="1362">Downloads</a></p></div></div><div class="col-md-4" data-reactid="1363"><div style="padding-left:100px;" data-reactid="1364"><p data-reactid="1365"><a target="_new" style="color:#FBF9E4;" href="https://www.npmjs.com/package/actionhero/" data-reactid="1366">NPM</a></p><p data-reactid="1367"><a target="_new" style="color:#FBF9E4;" href="https://twitter.com/actionherojs/" data-reactid="1368">Twitter</a></p><p data-reactid="1369"><a target="_new" style="color:#FBF9E4;" href="https://slack.actionherojs.com/" data-reactid="1370">Slack</a></p><p data-reactid="1371"><a target="_new" style="color:#FBF9E4;" href="https://github.com/actionhero/actionhero/" data-reactid="1372">Github</a></p></div></div></div></div></footer></div></div></div></div><div id="__next-error"></div></div><div><script>
          __NEXT_DATA__ = {"props":{},"pathname":"/docs/core/tasks","query":{},"buildId":"e2246878-227f-4809-bcfe-8b4d3e2ec98c","buildStats":{"app.js":{"hash":"517642acd6437ad7e589c92138f402c3"}},"assetPrefix":"","nextExport":true,"err":null,"chunks":[]}
          module={}
          __NEXT_LOADED_PAGES__ = []
          __NEXT_LOADED_CHUNKS__ = []

          __NEXT_REGISTER_PAGE = function (route, fn) {
            __NEXT_LOADED_PAGES__.push({ route: route, fn: fn })
          }

          __NEXT_REGISTER_CHUNK = function (chunkName, fn) {
            __NEXT_LOADED_CHUNKS__.push({ chunkName: chunkName, fn: fn })
          }
        </script><script async="" id="__NEXT_PAGE__/docs/core/tasks" type="text/javascript" src="/_next/e2246878-227f-4809-bcfe-8b4d3e2ec98c/page/docs/core/tasks/index.js"></script><script async="" id="__NEXT_PAGE__/_error" type="text/javascript" src="/_next/e2246878-227f-4809-bcfe-8b4d3e2ec98c/page/_error/index.js"></script><div></div><script type="text/javascript" src="/_next/517642acd6437ad7e589c92138f402c3/app.js" async=""></script></div></body></html>